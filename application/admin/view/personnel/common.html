<style>
    .form-group {
        height: 39px !important;
    }
    #jia:hover {
        cursor: hand;

    }

</style>
<div class="row">
    <div class="col-sm-12">
        <div class="ibox float-e-margins">
            <div id="form1"  class="form-horizontal">
                <div class="ibox-title">
                    <h5>基础信息
                    </h5>
                </div>
                <div class="ibox-content">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label">*&nbsp姓名</label>
                            <div class="col-sm-8">
                                <input value="{$data['nickname']}" name="nickname" type="text" class="form-control">
                                <input name="id" value="{$data['id']}" type="hidden"/>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">部门</label>
                            <div class="col-sm-8">
                                <select name="group" class="form-control">
                                    {volist name="tree" id="z"}
                                    <option value="{$z->id}">{$z->title_display}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">显示顺序</label>
                            <div class="col-sm-8">
                                <input name="order" value="{$data['order']}" type="text" class="form-control" >
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">性别</label>

                            <div class="col-sm-8">
                                <div class="radio" style="float: left">
                                    <label>
                                        <input name="sex" type="radio" checked="" value="男">男</label>
                                </div>
                                <div class="radio" style="float: left ; margin-left: 13px;">
                                    <label>
                                        <input name="sex" type="radio" value="女">女</label>
                                </div>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">手机</label>

                            <div class="col-sm-8">
                                <input name="mobile" type="text" value="{$data['mobile']}"  placeholder="" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">工作电话</label>

                            <div class="col-sm-8">
                                <input name="work_phone" type="text" value="{$data['work_phone']}" placeholder="" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">家庭电话</label>

                            <div class="col-sm-8">
                                <input name="home_telephone" type="text" value="{$data['home_telephone']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">QQ</label>

                            <div class="col-sm-8">
                                <input name="qq" type="text" placeholder="" value="{$data['qq']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label">*&nbsp账号</label>
                            <div class="col-sm-8">
                                <input name="username" type="text" value="{$data['username']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">工号</label>
                            <div class="col-sm-8">
                                <input name="job_number" type="text" value="{$data['job_number']}" class="form-control"> <span
                                    class="help-block m-b-none"></span>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">菜单角色</label>
                            <div class="col-sm-8">
                                <select name="auth_group" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="character"  id="a" }
                                    <option value="{$key}">{$a}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">出生日期</label>
                            <div class="col-sm-8">
                                <input id="date_of_birth" value="{$data['date_of_birth']}" name="date_of_birth" type="text" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">邮箱</label>

                            <div class="col-sm-8">
                                <input name="email" value="{$data['email']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">住址</label>

                            <div class="col-sm-8">
                                <input name="address" value="{$data['address']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">登录设置</label>
                            <div class="col-sm-8">
                                <select  name="status" class="form-control">
                                    <option value="1">允许登录</option>
                                    <option value="0">禁止登录</option>
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">工作排班</label>
                            <div class="col-sm-8">
                                <select name="Job_scheduling" class="form-control">
                                    <option value="0" >请选择</option>
                                    <option value="1">早班</option>
                                    <option value="2">晚班</option>
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>
                    <div class="col-sm-4">
                        <div style="border: 1px solid  red;width: 80%;height: 350px;margin: 0 auto">
                            <img id="img" src="/{:get_avatar($data['avatar'])}" style="width: 100%;height: 350px;">
                        </div>
                        <input name="avatar" id="imgAvatar" type="hidden" value="{$data['avatar']}">
                        <div style="margin: 0 auto;display:flex;align-items: center">
                            <button style="margin: 0 auto;" class="btn btn-success"
                                    onclick="document.getElementById('addImg').click()" id="test1">
                                <i class="fa fa-upload"></i>&nbsp上传头像
                            </button>
                        </div>
                            <input accept="image/*" class="none" type="file" id="addImg" name="file[]"
                                   onchange="uplodeImg(files)" value=""/>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">直接上级</label>
                            <div class="col-sm-8">
                                <input   placeholder="" value="{$data['direct_superior_name']}" onclick="person({name:this, hiddenname: 'direct_superior',})"   type="text" class="form-control">
                                <input  type="hidden" name="direct_superior" value="{$data['direct_superior']}">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>
                    {empty name="isAdd"}
                    <div class="col-sm-12">
                        <table class="table table-striped table-bordered table-hover dataTable ">
                            <thead>
                            <th>职位名称
                                <i id="jia" onclick="edit()" class="iconfont icon-jia"></i>
                            </th>
                            <th>关联部门</th>
                            <th>操作</th>
                            </thead>
                            <tbody>
                                {volist name="$data['position_group']" id = "po"}
                                    <tr>
                                        <td>{$po['position_id_name']}</td>
                                        <td>{$po['group_id_name']}</td>
                                        <td>
                                            <span onclick=edit({:json_encode($po)}) class="btn btns btn-common">编辑</span>
                                            <span onclick=del({:json_encode($po)}) class="btn btns btn-del">删除</span>
                                        </td>
                                    </tr>
                                {/volist}
                            </tbody>
                        </table>
                    </div>
                    {/empty}
                </div>

                <div class="ibox-title">
                    <h5>档案信息
                    </h5>
                </div>

                <div id="ibox-content" class="ibox-content">

                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label">档案编号</label>

                            <div class="col-sm-8">
                                <input name="file_number" value="{$data['getRecord']['file_number']}" type="text" class="form-control">
                                <input name="rid" value="{$data['getRecord']['rid']}" type="hidden"/>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">入职日期</label>
                            <div class="col-sm-8">
                                <input id="date_on_board" value="{$data['getRecord']['date_on_board']}" name="date_on_board" type="text" placeholder="提示信息" class="form-control">
                                <span class="help-block m-b-none"></span>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">身份证号</label>
                            <div class="col-sm-8">
                                <input name="id_number" value="{$data['getRecord']['id_number']}" type="text" class="form-control" name="text">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">曾用名</label>

                            <div class="col-sm-8">
                                <input name="former_name" value="{$data['getRecord']['former_name']}" type="text" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">英文名</label>

                            <div class="col-sm-8">
                                <input name="english_name" value="{$data['getRecord']['english_name']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">婚姻状况</label>

                            <div class="col-sm-8">
                                <select name="marital_status" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="marital_status"  id="a" key='b'}
                                    <option value="{$b}">{$a}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">参加工作日期</label>

                            <div class="col-sm-8">
                                <input id="work_date" name="work_date" value="{$data['getRecord']['work_date']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">岗位级别</label>

                            <div class="col-sm-8">
                                <select name="job_level" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="job_level"  id="c" key='d'}
                                    <option value="{$d}">{$c}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">职称级别</label>

                            <div class="col-sm-8">
                                <select name="title_level" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="title_level"  id="e" key='f'}
                                    <option value="{$f}">{$e}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">最高学历</label>

                            <div class="col-sm-8">
                                <select name="highest_education" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="highest_education"  id="g" key='h'}
                                    <option value="{$h}">{$g}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">最高学位</label>

                            <div class="col-sm-8">
                                <select name="highest_degree" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="highest_degree"  id="i" key='j'}
                                    <option value="{$j}">{$i}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">健康状况</label>

                            <div class="col-sm-8">
                                <input name="health_status" value="{$data['getRecord']['health_status']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">银行</label>

                            <div class="col-sm-8">
                                <input name="bank" type="text" value="{$data['getRecord']['bank']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">社保卡号</label>

                            <div class="col-sm-8">
                                <input name="social_security_card_number" value="{$data['getRecord']['social_security_card_number']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label">在职状态</label>

                            <div class="col-sm-8">
                                <select name="working_state" class="form-control">
                                    <option value='1'>在职</option>
                                    <option value='2'>离职</option>
                                    <option value='3'>退休</option>
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">转正日期</label>
                            <div class="col-sm-8">
                                <input id="positive_date" name="positive_date" value="{$data['getRecord']['positive_date']}" type="text" class="form-control"> <span
                                    class="help-block m-b-none"></span>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">户口类别</label>

                            <div class="col-sm-8">
                                <select name="account_types" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="account_types"  id="k" key='l'}
                                    <option value="{$l}">{$k}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">民族</label>

                            <div class="col-sm-8">
                                <input name="famous_family" value="{$data['getRecord']['famous_family']}" type="text" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">国籍</label>

                            <div class="col-sm-8">
                                <input name="country_citizenship" value="{$data['getRecord']['country_citizenship']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">政治面貌</label>

                            <div class="col-sm-8">
                                <select name="political_status" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="political_status"  id="m" key='n'}
                                    <option value="{$n}">{$m}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">行政级别</label>

                            <div class="col-sm-8">
                                <input name="administrative_level" value="{$data['getRecord']['administrative_level']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">岗位</label>
                            <div class="col-sm-8">
                                <select name="post" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="post"  id="o" key='p'}
                                    <option value="{$p}">{$o}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">职称</label>
                            <div class="col-sm-8">
                                <select name="job_title" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="job_title"  id="q" key='r'}
                                    <option value="{$r}">{$q}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">毕业学校</label>

                            <div class="col-sm-8">
                                <input name="graduated_school" value="{$data['getRecord']['graduated_school']}" type="text" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">所学专业</label>

                            <div class="col-sm-8">
                                <input name="major" value="{$data['getRecord']['major']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">身高(cm)</label>

                            <div class="col-sm-8">
                                <input name="height" value="{$data['getRecord']['height']}" type="text" class="form-control">
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">银行帐号</label>

                            <div class="col-sm-8">
                                <input name="bank_account" value="{$data['getRecord']['bank_account']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">社保电脑号</label>
                            <div class="col-sm-8">
                                <input name="social_security_computer_number" value="{$data['getRecord']['social_security_computer_number']}" type="text" class="form-control"> <span
                                    class="help-block m-b-none"></span>
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                    </div>

                    <div class="col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-4 control-label">员工类型</label>

                            <div class="col-sm-8">
                                <select name="employee_type" class="form-control">
                                    <option value="0">请选择</option>
                                    {volist name="employee_type"  id="s" key='t'}
                                    <option value="{$t}">{$s}</option>
                                    {/volist}

                                </select>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">离职日期</label>
                            <div class="col-sm-8">
                                <input id="resignation_date" name="resignation_date" type="text" value="{$data['getRecord']['resignation_date']}" class="form-control"> <span
                                    class="help-block m-b-none"></span>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">户口所在地</label>

                            <div class="col-sm-8">
                                <input name="account_location" type="text" value="{$data['getRecord']['account_location']}" class="form-control" >
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">籍贯</label>

                            <div class="col-sm-8">
                                <input name="birthplace" type="text" value="{$data['getRecord']['birthplace']}" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">护照</label>

                            <div class="col-sm-8">
                                <input name="passport" type="text" value="{$data['getRecord']['passport']}" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">政貌取得日期</label>

                            <div class="col-sm-8">
                                <input id="political_status_date" name="political_status_date" value="{$data['getRecord']['political_status_date']}" type="text" placeholder="提示信息" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">外语种类</label>
                            <div class="col-sm-8">
                                <input name="foreign_language_type" value="{$data['getRecord']['foreign_language_type']}" type="text" class="form-control">
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">职称取得日期</label>

                            <div class="col-sm-8">
                                <input id="title_acquisition_date" name="title_acquisition_date" value="{$data['getRecord']['title_acquisition_date']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">毕业日期</label>

                            <div class="col-sm-8">
                                <input id="graduation_date" name="graduation_date" type="text" value="{$data['getRecord']['graduation_date']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">业余爱好</label>

                            <div class="col-sm-8">
                                <input name="hobby" type="text" value="{$data['getRecord']['hobby']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">体重(kg)</label>

                            <div class="col-sm-8">
                                <input name="body_weight" type="text" value="{$data['getRecord']['body_weight']}" class="form-control">
                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">公积金号</label>

                            <div class="col-sm-8">
                                <input name="provident_fund" type="text" value="{$data['getRecord']['provident_fund']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">薪资标识</label>

                            <div class="col-sm-8">
                                <input name="salary_identification" type="text" value="{$data['getRecord']['salary_identification']}" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">紧急联系人电话</label>

                            <div class="col-sm-8">
                                <input name="emergency_contact_phone" value="{$data['getRecord']['emergency_contact_phone']}" type="text" class="form-control" >
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">紧急联系人</label>

                            <div class="col-sm-8">
                                <input name="emergency_contact" value="{$data['getRecord']['emergency_contact']}" type="text" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>


                    <label style="margin-top: 10px" class="col-sm-1 control-label">附件</label>
                    <div class="col-sm-11 js-upload-files">
                        <ul class="list-group uploader-list" id="file_list_file">
                            {php}
                            $files_ids = [];
                            {/php}
                            {notempty name="$files"}
                            {volist name="files" id="f"}
                            <li class="list-group-item file-item">
                    					<span class="pull-right file-state">
                    						<span class="text-success">已上传</span>
                    					</span>
                                <i class="fa fa-file"></i>
                                {$f['name']}
                                [<a href="{$f['path']}" class="download-file" download="{$f['name']}">下载</a>]
                                [<a class="remove-file" onclick="deleteFile({$f['id']}, this)">删除</a>]
                            </li>
                            {php}

                            array_push($files_ids, $f['id']);
                            {/php}
                            {/volist}
                            {/notempty}
                        </ul>
                        <div onclick="document.querySelector('#addFiles').click()" class="webuploader-pick">上传多个文件</div>
                    </div>

                    <div class="col-sm-12">
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-1 control-label">备注</label>
                            <div class="col-sm-11">
                                <textarea id="textarea" value="" name="remarks"   class="form-control">{$data['getRecord']['remarks']}</textarea>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                    </div>
                    <div class="col-sm-12" style="text-align: center;">
                        <div>
                            <button type="button" onclick="save()" class="btn btn-w-m btn-primary">提交</button>
                            <button type="button" onclick="javascript:history.back(-1);return false;" class="btn btn-w-m btn-default">返回</button>
                        </div>
                    </div>
                    <form id="file">
                        <input class="none" type="file" id="addFiles" name="file[]" multiple="multiple" onchange="addFile()"  value="" />
                    </form>
                    <div class="ibox-title"></div>
                </div>
            </div>
        </div>
    </div>
    {empty name="isAdd"}
    <div class="editinp3" style="display: none;height: 100%;overflow: auto;">
        <div class="ibox-content">
            <form id="form2">
                <label>职位名称</label>
                <select class="form-control m-b flowtype"  name="position_id">
                    {volist name="tree2" id="z2"}
                    <option value="{$z2->id}">{$z2->title_display}</option>
                    {/volist}
                </select>
                <input value="0" type="radio" name="main_position" checked >主职
                <input  value="1" type="radio" name="main_position" >兼职
                <label style="display: block;margin-top: 10px" >任职日期</label>
                <input  id="rzrq" name="create_time" type="text" placeholder=""  class="form-control">
                <label style="margin-top: 10px" >关联部门</label>
                <select class="form-control m-b flowtype"  name="group_id">
                    {volist name="tree" id="z"}
                    <option value="{$z->id}">{$z->title_display}</option>
                    {/volist}
                </select>
            </form>
        </div>
    </div>
    {/empty}
</div>
{include file="public/person"/}
2<script>

    //附件id
    {empty name="files_ids"}
    var fileids = [];
    {else/}
        var fileids = {:json_encode($files_ids)};
    {/empty}

        $(document).ready(function () {

            document.body.style.height = "100%";


            laydate.render({
                elem:'#date_of_birth'
            });

            laydate.render({
                elem:'#date_on_board'
            });
            laydate.render({
                elem:'#work_date'
            });
            laydate.render({
                elem:'#graduation_date'
            });
            laydate.render({
                elem:'#title_acquisition_date'
            });
            laydate.render({
                elem:'#political_status_date'
            });
            laydate.render({
                elem:'#resignation_date'
            });
            laydate.render({
                elem:'#positive_date'
            });
            laydate.render({
                elem:'#rzrq'
            });
        });

    {empty name="isAdd"}
        $('select[name=group]').find('option[value={$data['group']}]').attr("selected", true);
        $('select[name=status]').find('option[value={$data['status']}]').attr("selected", true);
        $('select[name=Job_scheduling]').find('option[value={$data['Job_scheduling']}]').attr("selected", true);
        $('select[name=role]').find('option[value={$data['role']}]').attr("selected", true);

        $("input[type=radio][name=sex][value={$data['sex']}]").attr("checked", "checked");


        $('select[name=working_state]').find('option[value="{$data['getRecord']['working_state']}"]').attr("selected", true);
        $('select[name=marital_status]').find('option[value="{$data[\'getRecord\']['marital_status']}"]').attr("selected", true);
        $('select[name=post]').find('option[value="{$data['getRecord']['post']}"]').attr("selected", true);
        $('select[name=job_title]').find('option[value="{$data[\'getRecord\']['job_title']}"]').attr("selected", true);
        $('select[name=highest_education]').find('option[value="{$data[\'getRecord\']['highest_education']}"]').attr("selected", true);
        $('select[name=highest_degree]').find('option[value="{$data[\'getRecord\']['highest_degree']}"]').attr("selected", true);
        $('select[name=account_types]').find('option[value="{$data[\'getRecord\']['account_types']}"]').attr("selected", true);
        $('select[name=political_status]').find('option[value="{$data[\'getRecord\']['political_status']}"]').attr("selected", true);
        $('select[name=job_level]').find('option[value="{$data[\'getRecord\']['job_level']}"]').attr("selected", true);
        $('select[name=title_level]').find('option[value="{$data[\'getRecord\']['title_level']}"]').attr("selected", true);
        $('select[name=employee_type]').find('option[value="{$data[\'getRecord\']['employee_type']}"]').attr("selected", true);
        $('select[name=auth_group]').find('option[value="{$Character}"]').attr("selected", true);
    {/empty}


   var input= $('#form1 input,select,textarea').not("#addFiles");


    function save() {
        var a={};

        input.each(function () {
            a[$(this).attr('name')] = $(this).val();
        });

        a['sex']=$("input[type=radio][name=sex]:checked").val();

        if (fileids.length > 0) {
            a['annex'] = fileids.join(',');
        } else {
            a['annex']='';
        }
        $.ajax({
            type: "post",
            url: "{:url('save')}",
            data: a,
            async: true,
            success: function (res) {
                if (res['code']) {
                    layer.msg(res['msg'], {
                        offset: [window.innerHeight/2, window.innerWidth / 2]
                    });
                    setTimeout(function () {
                        location.href = '{:url("index")}'
                    }, 1500)
                }  else {
                    layer.msg(res['msg'], {
                        offset: [window.innerHeight/2, window.innerWidth / 2]
                    });
                }
            }
        });
    }

    function uplodeImg(value) {
            if (value.length === 0) {
                layer.msg('请上传图片');
                return;
            }
            //得到头像
            var reads= new FileReader();
                    reads.readAsDataURL(value[0]);
                    reads.onload=function (e) {
                        $.ajax({
                            type: "post",
                            url: "{:url('uplodeImg')}",
                            data: {base: this.result,name:value[0].name},
                            async: true,
                            success: function (res) {
                                if (res.code) {
                                    document.getElementById('img').src = '/'+res['data']['success']['path'];
                                 $('input[name=avatar]').val(res['data']['success']['id']);
                                    layer.msg(res.msg)
                                }else{
                                    layer.msg(res.msg)
                                }
                            }
                        });
                    }
        }

    function addFile(){
        var seeting = {
            id: 'file',
            validate: [
                ["file",  '附件不能为空'],
            ],
            append: [['to_dir', 'personnel']],
            url: "{:url('AdminFiles/UpLoadFiles')}",
        }
        //提交
        util.ajax(seeting).then(function(res){
            if (res.code == 1) {
                var success = res.data.success;
                var str = '';
                for (var i = 0;  i < success.length; i ++) {
                    fileids.push(Number(success[i]['id']));
                    str += `<li class="list-group-item file-item">
                    					<span class="pull-right file-state">
                    						<span class="text-success">上传成功</span>
                    					</span>
                    					<i class="fa fa-file"></i>
                    					${success[i]['name']}
                    					 [<a href="${success[i]['path']}" class="download-file" download="${success[i]['name']}">下载</a>]
                    					 [<a class="remove-file" onclick="deleteFile(${success[i]['id']}, this)">删除</a>]
                    				</li>`;
                }
                var fail = res.data.fail;

                for (var i = 0;  i < fail.length; i ++) {
                    str += `<li class="list-group-item file-item">
                    					<span class="pull-right file-state">
                    						<span class="text-success">上传失败(${fail[i]['err']})</span>
                    					</span>
                    					<i class="fa fa-file"></i>
                    					${fail[i]['name']}
                    				</li>`;
                }
                $("#file_list_file").append(str);
            } else {
                alert('上传失败');
            }
        }).catch(e => {
            console.log(e);
            alert('上传失败, 请联系管理员');
        })


    }

    function deleteFile(id, o){
        var index = fileids.indexOf(Number(id));
        if (index !== -1) {
            fileids.splice(index, 1);
            $(o).parents('li').remove();
        }
    }

    function del(obj) {

        layer.confirm('确定删除吗？', {
                btn: ['确定', '取消'],
                icon: 2,
                shade: false, //不显示遮罩
                offset: '200px',
            }, function () {
                $.ajax({
                    type: "post",
                    url: "{:url('DepartmentPosition/delete')}",
                    data: {"id": obj.id},
                    async: true,
                    success: function (res) {
                        if (res['code']) {
                            layer.msg(res['msg'],{offset:'500px'});
                            setTimeout(function () {
                                location.reload();
                            }, 1500)
                        } else {
                            layer.msg(res['msg']);
                        }
                    }
                });
            }
        );


    }

        {empty name="isAdd"}
        function edit(obj){

            if(!obj){
                var id={$data['id']};
                obj = {};
                obj['user_id'] = id;
                var form2= document.getElementById('form2');
                form2.reset();
                var pi= document.getElementsByName('position_id')[0];
                var gi= document.getElementsByName('group_id')[0];
                var mp= document.getElementsByName('main_position');
                pi.options[0].selected = true;
                gi.options[0].selected = true;
                mp[0].checked = true;

            }else {
                $(".editinp3 input[type=radio][name=main_position][value="+obj.main_position+"]").attr("checked", "checked");
                $('.editinp3 select[name=position_id]').find("option[value="+obj.position_id+"]").attr("selected", true);
                $('.editinp3 select[name=group_id]').find("option[value="+obj.group_id+"]").attr("selected", true);

                $('.editinp3  input[name=create_time]').val(obj.create_time);
            }

            layer.open({
                type: 1,
                title: '编辑',
                btn: ['提交'],
                skin: 'layui-layer-molv',
                offset: '30px',
                area: ['500px', '500px'],
                content: $('.editinp3'),
                yes: function () {
                    var jsonData = $("#form2").serializeArray();
                    jsonData.push({"name": "id", "value": obj.id});
                    jsonData.push({"name": "user_id", "value": obj.user_id});
                    jsonData[2] = jsonData[2].value ? jsonData[2] : null;

                    $.ajax({
                        type: "post",
                        url: "{:url('DepartmentPosition/add')}",
                        data: jsonData,
                        async: true,
                        success: function (res) {
                            if (res['code']) {
                                confirm(res['msg']);
                                setTimeout(function () {
                                    location.reload();
                                }, 1500)
                            } else {
                                confirm(res['msg']);
                            }
                        }
                    })
                }
            });
        }
        {/empty}


    function person(o){
        //皆为非传参数, 默认 多选人员
//         var seeting = {
//             //是否只选部门或职位
//             // onlyOrganization: true,
//             //是否单选
//             radio: true,
//             //默认选中 checked支持,隔开的字符串及数组
// //			checked: '4',
// //			是否是选择职位
// // 			position: true,
//             //文件赋值input或textarea
//             name: o,
//             //id赋值input
//             hiddenname: 'direct_superior',
//             //确定回调方法
//             // callback: function(option){
//             //     // ...do you someting
//             //     $('#textarea').text(option.text[0]);
//             //     $('#textareaId').val(option.ids[0]);
//             // }
// //取消回调
// //			cancel: function(option){
//             //...do you someting
//             //console.log(option)
// //			}
//         };

        new openPerson(o);
    }

</script>